<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>Backwoods Field Notebook - Mobile Full</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    :root {
      --bg-gray: #111827;
      --paper: #faf7f2;
      --line: #e2ddd4;
      --margin-line: #c4a58c;
      --margin-line-new: #b8987b;
      --text-main: #222222;
      --text-sub: #6b7280;
      --accent: #111111;
      --accent-blue: #2563eb;
      --highlight-yellow: #fde047;
      --highlight-text: #854d0e;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      min-height: 100vh;
      background: var(--bg-gray);
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    .notebook-card {
      width: 100%;
      max-width: 600px;
      margin: 0 auto;
      min-height: 100vh;
      background: #020617;
      display: flex;
      flex-direction: column;
    }

    .spiral-header {
      padding: 12px 16px 8px;
      background: linear-gradient(135deg, #020617, #111827);
      color: #e5e7eb;
      box-shadow: 0 2px 6px rgba(0,0,0,0.5);
    }

    .spiral-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 6px;
    }

    .spiral-holes {
      display: flex;
      gap: 6px;
    }

    .spiral-hole {
      width: 13px;
      height: 13px;
      border-radius: 999px;
      background: #020617;
      box-shadow:
        0 0 0 2px #d4d4d4,
        inset 0 0 3px rgba(0,0,0,0.9);
      position: relative;
    }

    .spiral-wire {
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      width: 19px;
      height: 3px;
      border-radius: 999px;
      background: #d4d4d4;
      box-shadow:
        0 2px 0 rgba(0,0,0,0.4),
        0 -1px 0 rgba(255,255,255,0.7);
    }

    .spiral-wire.top { top: -6px; }
    .spiral-wire.bottom { bottom: -6px; }

    .lab-header-text {
      text-align: right;
      font-size: 0.72rem;
      letter-spacing: 0.16em;
      text-transform: uppercase;
      color: #9ca3af;
    }

    .lab-main-title {
      margin-top: 4px;
      font-size: 1.1rem;
      font-weight: 600;
      letter-spacing: 0.18em;
      text-transform: uppercase;
    }

    .lab-subtitle {
      margin-top: 2px;
      font-size: 0.8rem;
      letter-spacing: 0.22em;
      text-transform: uppercase;
      color: #d1d5db;
    }

    .paper-wrap {
      flex: 1;
      background: #111827;
      padding: 10px 16px 16px;
      overflow-y: auto;
    }

    .paper {
      position: relative;
      border-radius: 14px;
      background:
        repeating-linear-gradient(
          to bottom,
          var(--paper) 0,
          var(--paper) 24px,
          var(--line) 25px
        );
      box-shadow:
        0 8px 18px rgba(0,0,0,0.45),
        0 0 0 1px rgba(0,0,0,0.25);
      padding: 18px 18px 18px 40px;
      min-height: calc(100vh - 110px);
    }

    .paper::before {
      content: "";
      position: absolute;
      top: 0;
      bottom: 0;
      left: 28px;
      width: 2px;
      background: linear-gradient(to bottom, transparent, var(--margin-line-new), transparent);
      opacity: 0.9;
    }

    .paper-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      margin-bottom: 6px;
    }

    .paper-header-left {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .paper-label {
      font-size: 0.8rem;
      color: var(--text-sub);
      letter-spacing: 0.16em;
      text-transform: uppercase;
    }

    .paper-title {
      font-size: 1.05rem;
      font-weight: 600;
      color: var(--text-main);
    }

    .paper-header-right {
      text-align: right;
      font-size: 0.72rem;
      color: var(--text-sub);
    }

    .stage-pill {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 2px 8px;
      border-radius: 999px;
      border: 1px solid #c4b5a5;
      font-size: 0.76rem;
      background: rgba(250, 247, 242, 0.95);
      color: var(--text-sub);
      text-transform: uppercase;
      letter-spacing: 0.14em;
    }

    .progress-wrap {
      margin: 4px 0 4px;
    }

    .progress-bar-bg {
      width: 100%;
      height: 4px;
      border-radius: 999px;
      background: rgba(0,0,0,0.06);
      overflow: hidden;
    }

    .progress-bar-fill {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, var(--accent-blue), #111827);
      transition: width 0.3s ease;
    }

    .progress-text {
      margin-top: 3px;
      font-size: 0.76rem;
      color: var(--text-sub);
      text-align: right;
    }

    .subtitle {
      font-size: 0.86rem;
      color: var(--text-sub);
      margin: 4px 0 6px;
    }

    .story-text {
      font-size: 0.95rem;
      color: var(--text-main);
      white-space: pre-line;
      line-height: 1.75;
      margin-bottom: 14px;
    }

    /* ë³¼ë“œ ì²˜ë¦¬ ë° ê¸€ì”¨ í¬ê¸° í‚¤ìš°ê¸° */
    .story-text strong {
      font-size: 1.05rem;
    }

    label {
      display: block;
      font-size: 0.86rem;
      color: var(--text-main);
      margin-bottom: 4px;
      margin-top: 4px;
    }

    input[type="tel"] {
      width: 100%;
      padding: 8px 10px;
      border-radius: 8px;
      border: 1px solid #c4b5a5;
      font-size: 0.95rem;
      font-family: inherit;
      background: rgba(255,255,255,0.98);
      color: var(--text-main);
    }

    input[type="tel"]:focus {
      outline: none;
      border-color: var(--accent-blue);
      box-shadow: 0 0 0 1px rgba(37, 99, 235, 0.5);
      background: #ffffff;
    }

    button {
      width: 100%;
      margin-top: 8px;
      padding: 9px 10px;
      border-radius: 999px;
      border: none;
      background: var(--accent);
      color: #ffffff;
      font-size: 0.82rem;
      font-weight: 600;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      cursor: pointer;
      box-shadow: 0 7px 16px rgba(0,0,0,0.35);
      transition: transform 0.05s ease, filter 0.06s ease, box-shadow 0.1s ease;
    }

    button:active {
      transform: translateY(1px);
      filter: brightness(0.93);
      box-shadow: 0 4px 9px rgba(0,0,0,0.4);
    }

    button:disabled {
      opacity: 0.5;
      cursor: default;
      box-shadow: none;
    }

    .message {
      margin-top: 4px;
      font-size: 0.82rem;
      min-height: 1.2em;
    }

    .message.error { color: #c62828; }
    .message.success { color: #2e7d32; }

    .hint {
      margin-top: 4px;
      padding: 6px 0;
      font-size: 0.8rem;
      color: var(--text-sub);
    }

    /* â­ ëˆˆì— ë„ê²Œ ê°•ì¡°ëœ íŒíŠ¸ ìŠ¤íƒ€ì¼ â­ */
    .hint.active {
      font-weight: 600;
      color: var(--highlight-text);
      background-color: var(--highlight-yellow);
      border-radius: 4px;
      padding: 8px 10px;
      margin-top: 8px;
      border: 1px solid var(--highlight-text);
    }

    .clear-block {
      margin-top: 12px;
      font-size: 0.9rem;
      color: var(--text-main);
      display: none;
    }

    .clear-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 2px 8px;
      border-radius: 999px;
      border: 1px solid #2e7d32;
      color: #2e7d32;
      font-size: 0.74rem;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      background: rgba(222, 247, 222, 0.9);
      margin-bottom: 4px;
    }

    .clear-title {
      font-weight: 600;
      margin-bottom: 4px;
    }

    .clear-text {
      font-size: 0.88rem;
      color: var(--text-sub);
      line-height: 1.6;
    }

    .restart-btn {
      margin-top: 10px;
      width: 100%;
      padding: 8px 10px;
      border-radius: 999px;
      border: 1px solid #111827;
      background: transparent;
      color: #111827;
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      cursor: pointer;
    }

    .restart-btn:active {
      transform: translateY(1px);
      filter: brightness(0.96);
    }
  </style>
</head>
<body>
  <div class="notebook-card">
    <div class="spiral-header">
      <div class="spiral-row">
        <div class="spiral-holes">
          <div class="spiral-hole">
            <div class="spiral-wire top"></div>
            <div class="spiral-wire bottom"></div>
          </div>
          <div class="spiral-hole">
            <div class="spiral-wire top"></div>
            <div class="spiral-wire bottom"></div>
          </div>
          <div class="spiral-hole">
            <div class="spiral-wire top"></div>
            <div class="spiral-wire bottom"></div>
          </div>
        </div>
        <div class="lab-header-text">
          BACKWOODS RESEARCH INSTITUTE
        </div>
      </div>
      <div class="lab-main-title">EGG FIELD LOG</div>
      <div class="lab-subtitle">GANGCHON BASE</div>
    </div>

    <div class="paper-wrap">
      <div class="paper">
        <div class="paper-header">
          <div class="paper-header-left">
            <div class="paper-label">FIELD NOTES</div>
            <div class="paper-title">
              ì‚°ê³¨ë²„ë ¤ì§„ ê³„ë€ì—°êµ¬ì†Œ â€” í•„ë“œ ë¡œê·¸
            </div>
          </div>
          <div class="paper-header-right">
            <div class="stage-pill" id="stageLabel">
              STAGE 1 / 6
            </div>
            <div id="progressText">0 / 6 CLEARED</div>
          </div>
        </div>

        <div class="progress-wrap">
          <div class="progress-bar-bg">
            <div class="progress-bar-fill" id="progressBar"></div>
          </div>
        </div>

        <div class="subtitle" id="stageSubtitle">
          íŒíŠ¸ë¥¼ ì½ê³  í˜„ì¥ì—ì„œ ì–»ì€ ì½”ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”.
        </div>
        <div class="story-text" id="storyText">
          ìŠ¤í…Œì´ì§€ ë‚´ìš©ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.
        </div>

        <div id="answerArea">
          <label for="answer">CODE / ì •ë‹µ</label>
          <input id="answer" type="tel" inputmode="numeric" autocomplete="off" />
          <button id="submitBtn">SUBMIT</button>
          <div id="message" class="message"></div>
          <div id="hint" class="hint"></div>
        </div>

        <div class="clear-block" id="clearBlock">
          <div class="clear-badge">
            <span>ğŸ‰</span><span>ALL STAGES CLEARED</span>
          </div>
          <div class="clear-title">í•„ë“œ ë¡œê·¸ ì‘ì„± ì™„ë£Œ</div>
          <div class="clear-text">
            ëª¨ë“  ìŠ¤í…Œì´ì§€ì—ì„œ ìˆ˜ì§‘í•œ ì½”ë“œê°€ ê¸°ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.<br />
            ì´ ë…¸íŠ¸ë¥¼ ë“¤ê³  ì§„í–‰ìë¥¼ ì°¾ì•„ê°€ ë‹¤ìŒ ì§€ë ¹ì„ ë°›ìœ¼ì„¸ìš”.
          </div>
          <button class="restart-btn" id="restartBtn">
            RESTART FROM STAGE 1
          </button>
        </div>
      </div>
    </div>
  </div>

  <script>
    const puzzles = [
      // ----------------------------------------------------
      // â­ STAGE 1 (ì¸ë±ìŠ¤ 0): í”„ë¡¤ë¡œê·¸. ì‚¬ë¼ì§„ ì‹œëŒ€ì˜ ì”í–¥
      // ----------------------------------------------------
      {
        subtitle: "í”„ë¡¤ë¡œê·¸. ì‚¬ë¼ì§„ ì‹œëŒ€ì˜ ì”í–¥",
        text: `ê³ ëŒ€ ìƒëª…ì²´ê°€ ì‚¬ë¼ì§„ ì‹œëŒ€
ì•„ì£¼ ì˜¤ë˜ì „, ê°•ì´Œ ì¸ê·¼ì—ëŠ” ì§€ê¸ˆì€ ê¸°ë¡ì—ì„œ ì‚¬ë¼ì§„ ê±°ëŒ€ ë¹„í–‰ ìƒëª…ì²´ê°€ ì¡´ì¬í–ˆë‹¤ëŠ” ì „ì„¤ë§Œ íë¦¿í•˜ê²Œ ë‚¨ì•„ ìˆë‹¤. í˜„ëŒ€ ê³¼í•™ìœ¼ë¡œëŠ” ì •ì²´ë¥¼ ì•Œ ìˆ˜ ì—†ëŠ” ìƒëª…ì²´ì˜€ê³ , ì–´ëŠ ìˆœê°„ í”ì  ì—†ì´ ì‚¬ë¼ì¡Œë‹¤. ì´ ì „ì„¤ì€ ì‚¬ì‹¤ ì—¬ë¶€ë„ ë¶ˆë¶„ëª…í•œ ì±„ ì§€ì—­ì˜ ì‹ í™”ì²˜ëŸ¼ë§Œ ì „í•´ì§„ë‹¤.

**í˜„ëŒ€ì˜ ì´ìƒ í˜„ìƒ â€“ ê°ì‘ìì˜ ë“±ì¥**
ìµœê·¼ ê°•ì´Œ ì¼ëŒ€ì—ì„œ 'ì •ì²´ë¶ˆëª…ì˜ ì—ë„ˆì§€ ê³µì§„(Resonance)'ì´ ê¸‰ê²©íˆ ì¦ê°€í•œë‹¤. ë ˆì´ë”ì—ëŠ” ì£¼ê¸°ì ìœ¼ë¡œ ì‹ í˜¸ê°€ ì°íˆì§€ë§Œ ê¸°ì¡´ ì¥ë¹„ë¡œëŠ” ë¶„ì„ë˜ì§€ ì•ŠëŠ”ë‹¤. ê·¸ëŸ¬ë˜ ì¤‘, ì´ ì‹ í˜¸ê°€ ê·¹ì†Œìˆ˜ì˜ ì¸ê°„ì—ê²Œë§Œ ê°ê°ì  ìê·¹ì„ ì£¼ëŠ” ê²ƒì´ ë°œê²¬ëœë‹¤. ê·¸ë“¤ì€ ê°ì‘ì(Sensor)ë¼ ë¶ˆë¦°ë‹¤.Â 

**ì¤‘ì‹¬ì— ë†“ì¸ ë¬¼ì²´ â€“ ë¶€í™”ê°€ ì•„ë‹Œ â€˜ê°ì„±â€™**
ê°•ì´Œ ì‚°ì† íŠ¹ì • ì§€ì ì—ì„œ ì•Œì²˜ëŸ¼ ìƒê¸´ ë™ê·¸ë€ ê²°ì •ì²´(Artifact)ê°€ ë°œê²¬ëœë‹¤. ë”°ëœ»í•˜ì§€ë„ ì°¨ê°‘ì§€ë„ ì•Šì€ ì´ ë¬¼ì²´ëŠ” ìƒì²´ ë°˜ì‘ë„, ê¸°ê³„ ë°˜ì‘ë„ ì•„ë‹Œ ë…íŠ¹í•œ íŒŒë™ì„ ë‚´ê³  ìˆë‹¤. ë‹¹ì´ˆ í•™ìë“¤ì€ ìƒëª…ì²´ì˜ ì•Œì´ë¼ê³  ì¶”ì¸¡í–ˆìœ¼ë‚˜, ì´í›„ ë¶„ì„ ê²°ê³¼ â†’ â€˜ìƒëª…ì²´ì  ì‹ í˜¸â€™ì™€ â€˜ì§€ì„±ì  íŒ¨í„´â€™ì´ ë™ì‹œì— ì¡´ì¬í•˜ëŠ”, ì •ì²´ë¶ˆëª…ì˜ ìœ ë¬¼ì´ë¼ëŠ” ê²°ë¡ ì´ ë‚´ë ¤ì§„ë‹¤.

ì´ì œ, ê°ì‘ì ì¤‘ í•œ ëª…ìœ¼ë¡œì„œ ë‹¹ì‹ ì€ í˜„ì¥ìœ¼ë¡œ íŒŒê²¬ëœë‹¤.`,Â 
        answer: "ì‹œì‘",
        hint: "í”„ë¡¤ë¡œê·¸ë¥¼ ëª¨ë‘ ì½ì—ˆë‹¤ë©´ ì •ë‹µ ì¹¸ì— 'ì‹œì‘'ì´ë¼ê³  ì…ë ¥í•´ ì£¼ì„¸ìš”."
      },
      // ----------------------------------------------------
      // â­ STAGE 2 (ì¸ë±ìŠ¤ 1): í”„ë¡¤ë¡œê·¸. ìˆ˜ì²©ì„ ì¤ë‹¤
      // ----------------------------------------------------
      {
        subtitle: "í”„ë¡¤ë¡œê·¸. ìˆ˜ì²©ì„ ì¤ë‹¤",
        text: `ì—´ì°¨ê°€ ë– ë‚œ ë’¤, ì”ì—´ì´ ë‚¨ì€ ë°”ëŒì´ í”Œë«í¼ì„ ìŠ¤ì¹˜ê³  ì§€ë‚˜ê°”ë‹¤.Â 
ê°ì‘ìë¡œì„œ íŒŒê²¬ëœ ì—°êµ¬ì›, ë‹¹ì‹ ì€ ë°°ë‚­ì„ ê³ ì³ ë§¤ë©° ì£¼ë³€ì„ ì‚´íˆë‹¤.
ë³´ê³ ëœ ê³µì§„ ì‹ í˜¸ëŠ” ëª¨ë‘ ì´ê³³, ê°•ì´Œì—­ì„ ì¤‘ì‹¬ìœ¼ë¡œ í¼ì ¸ ë‚˜ê°€ê³  ìˆì—ˆë‹¤.Â 
ë‹¹ì‹ ì€ íŠ¹ë³„í•œ ì¥ë¹„ ì—†ì´ ìì‹ ì˜ ê°ê°ì—ë§Œ ì˜ì¡´í•´ì•¼ í•˜ëŠ” ì²« íŒŒê²¬ ì„ë¬´ì—Â 
ìµìˆ™ì§€ ì•Šì€ ê¸´ì¥ì„ ëŠë¼ê³  ìˆì—ˆë‹¤.

ê·¸ë•Œ, ë°œì¹˜ë¡œ ì‘ì€ ê·¸ë¦¼ìê°€ êµ´ëŸ¬ì™”ë‹¤.
ë°”ëŒì˜ ë°©í–¥ê³¼ë„ ë§ì§€ ì•ŠëŠ”, ì„¤ëª…í•˜ê¸° ì–´ë ¤ìš´ ê¶¤ì ì´ì—ˆë‹¤.
ë‹¹ì‹ ì€ ë¬´ì‹¬ì½” í—ˆë¦¬ë¥¼ êµ½í˜€ ê·¸ê²ƒì„ ì£¼ì›Œ ë“¤ì—ˆë‹¤.

**ìˆ˜ì²©.**
ê°•ì´Œì˜ ì§€ë„ë¥¼ ë‹®ì€ ë“¯í•œ íŠ¹ì´í•œ í‘œì§€, ì†ëì— ì „í•´ì§€ëŠ” ë¯¸ì„¸í•œ ë–¨ë¦¼.Â 
ë§ˆì¹˜ ì˜¤ë«ë™ì•ˆ ëˆ„êµ°ê°€ë¥¼ ê¸°ë‹¤ë ¤ì˜¨ ë¬¼ê±´ì²˜ëŸ¼ ëŠê»´ì¡Œë‹¤.Â 

ë‹¹ì‹ ì€ ì²œì²œíˆ ì²« í˜ì´ì§€ë¥¼ í¼ì³¤ë‹¤.

**<ì´ ìˆ˜ì²©ì„ ì¤ëŠ” ì, ê³µì§„ì„ ëŠë‚„ ë¿ ì•„ë‹ˆë¼ ë“¤ì„ ìˆ˜ ìˆë‹¤.>**
ë¬¸ì¥ê³¼ ë™ì‹œì—,
ê·“ì† ê¹Šì€ ê³³ì—ì„œ ë‚®ê³  ë¬µì§í•œ íŒŒë™ì´ ìš¸ë ¸ë‹¤.Â 
ë³´ê³ ì„œì—ì„œ ë¬˜ì‚¬ë˜ë˜ ê·¸ ê°ê°.
ì¼ë°˜ì¸ì€ ëŠë‚„ ìˆ˜ ì—†ê³ , ê°ì‘ìë§Œì´ ë“¤ì„ ìˆ˜ ìˆë‹¤ëŠ” ì‹ í˜¸.

ë‹¹ì‹ ì€ ìˆ¨ì„ ê°€ë³ê²Œ ì‚¼ì¼°ë‹¤.
ìˆ˜ì²©ì€ ê·¸ì˜ ì†ì—ì„œ ì•„ì£¼ ê¸°ë¬˜í•˜ê²Œ ë–¨ë¦¬ê³  ìˆì—ˆë‹¤.Â 
ë™ì‹œì— ì•„í‹°íŒ©íŠ¸ ì—­ì‹œ ê³µëª…í–ˆë‹¤.
ë§ˆì¹˜ ê·¸ê°€ ì˜¤ê¸°ë¥¼ ì•Œê³  ìˆì—ˆë‹¤ëŠ” ë“¯ì´.

ì´ ìˆ˜ì²©ì„ ì§‘ì–´ë“  ìˆœê°„, ì´ë¯¸ ì¡°ì‚¬ê°€ ì•„ë‹ˆë¼,
**ìƒˆë¡œìš´ ê²ƒì´ ì‹œì‘ë˜ì—ˆë‹¤ëŠ” ì‚¬ì‹¤**ì„ ë¶ˆí˜„ë“¯ ê¹¨ë‹¬ì•˜ë‹¤.

ê³µëª…ì€ ìì—°ìŠ¤ë ˆ ì•ì˜ ì¹´í˜ë¡œ í–¥í–ˆë‹¤.
ë‹¹ì‹ ì€ ê·¸ ê³µëª…ì„ ë”°ë¼, ì¹´í˜ë¡œ í–¥í•œë‹¤.

(ë°”ë‹¥ì˜ QRì½”ë“œë¥¼ ì°ì–´ ë¬¸ì œë¥¼ í™•ì¸í•˜ì„¸ìš”.)`,
        answer: "ì½”ë“œì…ë ¥",
        hint: "QRì½”ë“œë¥¼ ì°ê³  ì–»ì€ ì •ë‹µì„ ì…ë ¥í•˜ì„¸ìš”."
      },
      // ----------------------------------------------------
      // â­ STAGE 3 (ì¸ë±ìŠ¤ 2): 1ì¥. ì”ì¬ íŒŒë™ì´ ê¹¨ì–´ë‚˜ë‹¤ (ë‚´ìš© ì±„ì›Œì•¼ í•¨)
      // ----------------------------------------------------
      {
        subtitle: "1ì¥. ì”ì¬ íŒŒë™ì´ ê¹¨ì–´ë‚˜ë‹¤",
        text: `ì—¬ê¸°ì— '1ì¥' ì‹œë‚˜ë¦¬ì˜¤ ë‚´ìš©ì„ ì±„ì›Œì£¼ì„¸ìš”. (ê¸°ì¡´ 2ì¥ ë‚´ìš©)`,
        answer: "code2",
        hint: "1ì¥ì˜ ì •ë‹µì„ ì…ë ¥í•˜ì„¸ìš”."
      },
      // ----------------------------------------------------
      // â­ STAGE 4 (ì¸ë±ìŠ¤ 3): 2ì¥. ì²«ë¬¸ì–‘ì´ ê¹¨ì–´ë‚œ ìˆœê°„ (ë‚´ìš© ì±„ì›Œì•¼ í•¨)
      // ----------------------------------------------------
      {
        subtitle: "2ì¥. ì²«ë¬¸ì–‘ì´ ê¹¨ì–´ë‚œ ìˆœê°„",
        text: `ì—¬ê¸°ì— ì‹œë‚˜ë¦¬ì˜¤ 2ì¥ ë‚´ìš©ì„ ì±„ì›Œì£¼ì„¸ìš”. (ê¸°ì¡´ 3ì¥ ë‚´ìš©)`,
        answer: "code3",
        hint: "2ì¥ì˜ ì •ë‹µì„ ì…ë ¥í•˜ì„¸ìš”."
      },
      // ----------------------------------------------------
      // â­ STAGE 5 (ì¸ë±ìŠ¤ 4): 3ì¥. ê³µì§„ì˜ ì²«í­ë°œ (ë‚´ìš© ì±„ì›Œì•¼ í•¨)
      // ----------------------------------------------------
      {
        subtitle: "3ì¥. ê³µì§„ì˜ ì²«í­ë°œ",
        text: `ì—¬ê¸°ì— ì‹œë‚˜ë¦¬ì˜¤ 3ì¥ ë‚´ìš©ì„ ì±„ì›Œì£¼ì„¸ìš”. (ê¸°ì¡´ 4ì¥ ë‚´ìš©)`,
        answer: "code4",
        hint: "3ì¥ì˜ ì •ë‹µì„ ì…ë ¥í•˜ì„¸ìš”."
      },
      // ----------------------------------------------------
      // â­ STAGE 6 (ì¸ë±ìŠ¤ 5): 4ì¥/5ì¥ (ë‚´ìš© ì±„ì›Œì•¼ í•¨)
      // ----------------------------------------------------
      {
        subtitle: "4ì¥. ê³ ëŒ€ìƒëª…ì²´ì˜ ì”ì¬í”ì  / 5ì¥. ë¬¸ì–‘ì–¸ì–´ì˜ ë“±ì¥",
        text: `ì—¬ê¸°ì— ì‹œë‚˜ë¦¬ì˜¤ 4ì¥ ë‚´ìš©ì„ ì±„ì›Œì£¼ì„¸ìš”. (ê¸°ì¡´ 5ì¥ ë‚´ìš©)`,
        answer: "code5",
        hint: "4ì¥ / 5ì¥ì˜ ì •ë‹µì„ ì…ë ¥í•˜ì„¸ìš”."
      }
    ];

    const totalStages = puzzles.length;
    let currentStage = 0;

    // ------------------------------------------------
    // âœ… ì´ ë¶€ë¶„ì´ ì˜¬ë°”ë¥´ê²Œ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.
    const stageLabelEl    = document.getElementById("stageLabel");
    const stageSubtitleEl = document.getElementById("stageSubtitle");
    const storyTextEl     = document.getElementById("storyText");
    const messageEl       = document.getElementById("message");
    const hintEl          = document.getElementById("hint");
    const answerInputEl   = document.getElementById("answer");
    const submitBtnEl     = document.getElementById("submitBtn");
    const progressBarEl   = document.getElementById("progressBar");
    const progressTextEl  = document.getElementById("progressText");
    const answerAreaEl    = document.getElementById("answerArea");
    const clearBlockEl    = document.getElementById("clearBlock");
    const restartBtnEl    = document.getElementById("restartBtn");
    // ------------------------------------------------

    function normalize(text) {
      return text.trim().replace(/\s/g, '').toLowerCase();
    }

    function updateProgress() {
      const cleared = currentStage;
      const percent = (cleared / totalStages) * 100;
      progressBarEl.style.width    = percent + "%";
      progressTextEl.textContent   = `${cleared} / ${totalStages} CLEARED`;
      stageLabelEl.textContent     = `STAGE ${currentStage + 1} / ${totalStages}`;
    }

    function renderStage() {
      const p = puzzles[currentStage];

      stageSubtitleEl.textContent = p.subtitle || "í˜„ì¥ ë¡œê·¸ë¥¼ ì½ê³  ì½”ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”.";
      storyTextEl.innerHTML       = p.text || "";
      messageEl.textContent       = "";
      messageEl.className         = "message";

      answerInputEl.value    = "";
      answerInputEl.disabled = false;
      submitBtnEl.disabled   = false;
      answerAreaEl.style.display = "block";
      clearBlockEl.style.display = "none";
      
      // íŒíŠ¸ ê°•ì¡° ì„¤ì •: í”„ë¡¤ë¡œê·¸ 1, 2ì¼ ë•Œ ê°•ì¡° ìŠ¤íƒ€ì¼ ì ìš© (0, 1 ì¸ë±ìŠ¤)
      if (currentStage === 0 || currentStage === 1) {
          hintEl.className = "hint active";
          hintEl.textContent = p.hint || "";
      } else {
          hintEl.className = "hint";
          hintEl.textContent = "íŒíŠ¸: " + (p.hint || "ì—†ìŒ");
      }

      updateProgress();
      answerInputEl.focus();
    }

    function showClear() {
      progressBarEl.style.width   = "100%";
      progressTextEl.textContent  = `${totalStages} / ${totalStages} CLEARED`;
      stageLabelEl.textContent    = `STAGE ${totalStages} / ${totalStages}`;
      answerAreaEl.style.display  = "none";
      clearBlockEl.style.display  = "block";
    }

    function checkAnswer() {
      const userAnswer = normalize(answerInputEl.value);
      const correct    = normalize(puzzles[currentStage].answer || "");

      if (!userAnswer) {
        messageEl.textContent = "ì •ë‹µ(ì½”ë“œ)ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.";
        messageEl.className   = "message error";
        return;
      }

      if (userAnswer === correct) {
        messageEl.textContent = "ê¸°ë¡ ì™„ë£Œ. ë‹¤ìŒ ì¥ìœ¼ë¡œ ë„˜ì–´ê°‘ë‹ˆë‹¤.";
        messageEl.className   = "message success";

        submitBtnEl.disabled   = true;
        answerInputEl.disabled = true;
        submitBtnEl.textContent = "âœ” NEXT LOADING...";

        setTimeout(() => {
          submitBtnEl.textContent = "SUBMIT";
          if (currentStage >= totalStages - 1) {
            showClear();
          } else {
            currentStage += 1;
            renderStage();
          }
        }, 900);
      } else {
        messageEl.textContent = "ì½”ë“œê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. í˜„ì¥ ê¸°ë¡ì„ ë‹¤ì‹œ í™•ì¸í•´ ë³´ì„¸ìš”.";
        messageEl.className   = "message error";
      }
    }

    submitBtnEl.addEventListener("click", checkAnswer);
    answerInputEl.addEventListener("keydown", (e) => {
      if (e.key === "Enter") checkAnswer();
    });

    if (restartBtnEl) {
      restartBtnEl.addEventListener("click", () => {
        currentStage = 0;
        renderStage();
      });
    }

    renderStage();
  </script>
</body>
</html>
